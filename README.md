# best_price

A Flutter e-commerce application with Firebase Cloud Messaging (FCM) push notifications.

## Features

- **Firebase Cloud Messaging (FCM)**: Push notifications support
- **Local Notifications**: Display notifications even when app is in foreground
- **Topic Subscriptions**: Subscribe/unsubscribe to notification topics
- **Notification Handling**: Handle foreground, background, and terminated state notifications

## Getting Started

### Prerequisites

- Flutter SDK (latest stable version)
- Firebase project configured for your app
- `google-services.json` file for Android (already added in `android/app/`)
- iOS configuration (if building for iOS)

### Firebase Cloud Messaging Setup

The app already includes a comprehensive FCM helper class at `lib/core/utils/fcm_helper.dart`.

#### Usage

1. **FCM is automatically initialized** when the app starts in `main.dart`

2. **Get FCM Token** (to send it to your backend):

```dart
String? fcmToken = await FcmHelper.instance.getFcmToken();
// Send this token to your backend
```

3. **Subscribe to Topics**:

```dart
await FcmHelper.instance.subscribeToTopic('all_users');
```

4. **Listen to Notifications**:

```dart
FcmHelper.instance.notificationStream.listen((message) {
  print('Notification: ${message.notification?.title}');
  // Handle notification
});
```

5. **Handle Notification Data**:
   The helper includes a placeholder method `_handleNotificationNavigation` where you can implement navigation logic based on notification data.

#### Notification States

- **Foreground**: Notifications are displayed as local notifications
- **Background**: Handled by `firebaseMessagingBackgroundHandler`
- **Terminated**: App opens from notification when user taps it

For detailed usage examples, see `lib/core/utils/fcm_usage_example.dart`.

## Firebase Configuration

The app uses Firebase options from `lib/firebase_options.dart` which is auto-generated by FlutterFire CLI.

### Android Setup

- `google-services.json` is already configured in `android/app/`
- Notification permissions are declared in `AndroidManifest.xml`
- Notification channel is configured as `best_price_notifications`

### iOS Setup

For iOS, ensure you have:

- Proper APNs certificates configured in Firebase Console
- Push Notifications capability enabled in Xcode
- Background modes enabled if needed

## Resources

- [Lab: Write your first Flutter app](https://docs.flutter.dev/get-started/codelab)
- [Cookbook: Useful Flutter samples](https://docs.flutter.dev/cookbook)
- [Firebase Messaging Documentation](https://firebase.google.com/docs/cloud-messaging)
- [FlutterFire Documentation](https://firebase.flutter.dev/)

For help getting started with Flutter development, view the
[online documentation](https://docs.flutter.dev/), which offers tutorials,
samples, guidance on mobile development, and a full API reference.
